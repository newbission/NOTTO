<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NOTTO Admin</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
  <style>
    .admin-content { display: none; }
    .admin-content.show { display: block; }
    [role="group"] { display: flex; gap: 0.5rem; }
    [role="group"] input { margin: 0; flex: 1; }
    [role="group"] button { margin: 0; white-space: nowrap; }
    .grid-3 { display: grid; grid-template-columns: 1fr auto 1fr; gap: 1rem; align-items: stretch; }
    .panel-title { display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem; }
    .panel-title strong { font-size: 0.9rem; white-space: nowrap; margin-right: auto; }
    .panel-title button { margin: 0; padding: 0.25rem 0.5rem; font-size: 0.75rem; }
    .panel-wrapper { border: 1px solid var(--pico-muted-border-color); border-radius: var(--pico-border-radius); overflow: hidden; }
    .panel-header { display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem; background: var(--pico-muted-border-color); font-size: 0.8rem; color: var(--pico-muted-color); }
    .panel-header input[type="checkbox"] { margin: 0; }
    .panel-header .col-name { flex: 1; }
    .panel-header .col-reason { width: 40%; text-align: right; }
    .sort-toggle { cursor: pointer; }
    .sort-toggle:hover { color: var(--pico-primary); }
    .btn-delete { --pico-background-color: #d32f2f; --pico-border-color: #d32f2f; --pico-color: #fff; }
    .btn-delete:hover { --pico-background-color: #b71c1c; --pico-border-color: #b71c1c; }
    .panel { padding: 0.25rem 0; height: 350px; overflow-y: auto; }
    .panel-item { display: flex; align-items: center; gap: 0.5rem; padding: 0.25rem 0.5rem; cursor: pointer; }
    .panel-item:hover:not(.deleted) { background: var(--pico-muted-border-color); }
    .panel-item input[type="checkbox"] { margin: 0; pointer-events: none; }
    .panel-item .name { flex: 1; }
    .panel-item.changed { background: #fff3cd; }
    .panel-item.changed:hover { background: #f0e68c; }
    .panel-item.deleted { background: #ffcdd2; text-decoration: line-through; opacity: 0.7; cursor: default; }
    .panel-item .meta { width: 40%; text-align: right; font-size: 0.8rem; color: var(--pico-muted-color); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    .move-buttons { display: flex; flex-direction: column; justify-content: center; gap: 0.5rem; }
    .move-buttons button { width: 3rem; margin: 0; }
    .actions { display: flex; gap: 0.5rem; margin-top: 0.5rem; }
    .actions button { margin: 0; }
    .save-bar { position: sticky; bottom: 0; background: var(--pico-background-color); padding: 1rem 0; border-top: 1px solid var(--pico-muted-border-color); display: flex; justify-content: space-between; align-items: center; gap: 1rem; }
    dialog { min-width: 300px; }
  </style>
</head>
<body>
  <main class="container">
    <h1>NOTTO Admin</h1>

    <!-- 인증 -->
    <article id="auth-section">
      <label>관리자 비밀번호
        <input type="password" id="password" placeholder="비밀번호 입력">
      </label>
      <button onclick="authenticate()">로그인</button>
    </article>

    <!-- 어드민 -->
    <section class="admin-content" id="admin-content">

      <!-- 요청 추가 -->
      <article>
        <header>요청 추가</header>
        <div role="group">
          <input type="text" id="direct-name" placeholder="이름 입력">
          <button onclick="addRequest()">추가</button>
        </div>
      </article>

      <!-- 요청 대기 -->
      <article>
        <div class="panel-title">
          <strong>등록 요청 대기 (<span id="pending-count">0</span>)</strong>
          <button class="btn-delete" onclick="deletePending()">삭제</button>
        </div>
        <div class="panel-wrapper">
          <div class="panel-header">
            <input type="checkbox" id="pending-select-all" onclick="toggleSelectAll('pending')">
            <span class="col-name">이름</span>
            <span class="col-reason">상태</span>
          </div>
          <div class="panel" id="pending-panel"></div>
        </div>
        <div class="actions">
          <button class="secondary" onclick="rejectSelected('pending')">선택 반려</button>
          <button onclick="approveSelected()">선택 승인</button>
        </div>
      </article>

      <!-- 이름 관리 -->
      <article>
        <header>이름 관리</header>
        <div class="grid-3">
          <div>
            <div class="panel-title">
              <strong>등록 (<span id="registered-count">0</span>)</strong>
              <button class="btn-delete" onclick="deleteSelected('registered')">삭제</button>
            </div>
            <div class="panel-wrapper">
              <div class="panel-header">
                <input type="checkbox" id="registered-select-all" onclick="toggleSelectAll('registered')">
                <span class="col-name">이름</span>
                <span class="sort-toggle" id="registered-sort" data-sort="asc" onclick="toggleSort('registered')">정렬 ↑</span>
              </div>
              <div class="panel" id="registered-panel"></div>
            </div>
          </div>
          <div class="move-buttons">
            <button id="btn-to-rejected" onclick="moveToRejected()" disabled>&gt;</button>
            <button id="btn-to-registered" onclick="moveToRegistered()" disabled>&lt;</button>
          </div>
          <div>
            <div class="panel-title">
              <strong>반려 (<span id="rejected-count">0</span>)</strong>
              <button class="btn-delete" onclick="deleteSelected('rejected')">삭제</button>
            </div>
            <div class="panel-wrapper">
              <div class="panel-header">
                <input type="checkbox" id="rejected-select-all" onclick="toggleSelectAll('rejected')">
                <span class="col-name">이름</span>
                <span class="col-reason">사유</span>
                <span class="sort-toggle" id="rejected-sort" data-sort="asc" onclick="toggleSort('rejected')">정렬 ↑</span>
              </div>
              <div class="panel" id="rejected-panel"></div>
            </div>
          </div>
        </div>
      </article>

      <!-- 저장/취소 -->
      <div class="save-bar">
        <span>변경사항: <strong id="changes-count">0</strong>건</span>
        <div class="actions">
          <button class="secondary" onclick="cancelChanges()">취소</button>
          <button onclick="saveChanges()">저장</button>
        </div>
      </div>
    </section>
  </main>

  <!-- 반려 사유 모달 -->
  <dialog id="reject-modal">
    <article>
      <header>반려 사유 입력</header>
      <input type="text" id="reject-reason" placeholder="사유 (선택사항)">
      <footer>
        <button class="secondary" onclick="closeRejectModal()">취소</button>
        <button onclick="confirmReject()">확인</button>
      </footer>
    </article>
  </dialog>

  <script src="scripts/admin.js"></script>
</body>
</html>

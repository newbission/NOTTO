name: Weekly Lotto Generation

on:
  schedule:
    # 매주 일요일 0시 (KST) = 토요일 15:00 (UTC)
    - cron: '0 15 * * 6'
  workflow_dispatch: # 수동 실행 가능

jobs:
  trigger-generation:
    runs-on: ubuntu-latest
    steps:
      - name: Call Vercel Cron API
        run: |
          if [ -z "${{ secrets.VERCEL_URL }}" ]; then
            echo "Error: VERCEL_URL secret is not set."
            echo "Please set VERCEL_URL to your deployed Vercel domain (e.g., https://notto.vercel.app)"
            exit 1
          fi
          
          echo "Triggering weekly generation..."
          response=$(curl -s -X POST "${{ secrets.VERCEL_URL }}/api/cron/weekly")
          echo "Response: $response"
